---
title: "[GAS/sec8] RPG Attribute #1"

date: 2024-06-01 00:00:00 +0900
author: yejin

categories: [Unreal, Udemy]
tags: [unreal, GAS, lecture]

math: true
---

<br>

# **8. RPG Attribute**

<br>

## **Modifier**

<br>

### **8.3. Attribute Based Modifiers**

<br>

Modifiersì™€ ì†ì„±

![image](https://github.com/user-attachments/assets/47fe4fdd-207c-4fa4-9515-513dfb09a8b5)

*   `Attribute Based`: ë‹¤ë¥¸ ì†ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ ì†ì„±ì„ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ì œê³µ

<br><br>

![image](https://github.com/user-attachments/assets/1cace783-c542-47d7-bf80-b86d32c1d099)

![image](https://github.com/user-attachments/assets/665ace20-5425-4cdd-9d06-9e5b93fc8bbd)

> í…ŒìŠ¤íŠ¸ìš© Actor_BPì™€ GE_BP. Modifier ë°°ì—´ì„ í™•ì¥í•´ ì—¬ëŸ¬ íš¨ê³¼ë¥¼ ì¤‘ì²©ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

* `Attribute to Capture`: overlap ì‹œ ëŒ€ìƒì´ ì–´ëŠ ì†ì„±ì„ ê°€ì ¸ì˜¬ ê²ƒì¸ì§€ ê²°ì •
  
  * *eg) `Target`ì—ê²Œ `Strength`ë¥¼ ë”í•¨*

* `Attribute Source`: overlap ì‹œ íš¨ê³¼ë¥¼ ìºë¦­í„°ì—ê²Œ ì ìš©ì‹œí‚¤ë¯€ë¡œ `Target` ì„ íƒ
  
* `Snapshot`: ì†ì„±ì„ ì–¸ì œ ìº¡ì²˜í•´ì•¼ í•˜ëŠ”ì§€, ì–¸ì œ í•´ë‹¹ ì†ì„± ê°’ì„ ì‚¬ìš©í• ì§€ ê²°ì •
  
<br>

### **8.4. Order of Operations**

<br>

![image](https://github.com/user-attachments/assets/60a0ecd3-6dd2-4a29-b1e0-3c75fd1f0803)

operatorë¥¼ ë³€ê²½í•´ Actorì—ê²Œ ë¶€ì—¬í•˜ëŠ” íš¨ê³¼ë¥¼ í™•ì¥ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ModifierëŠ” ìˆœì„œëŒ€ë¡œ ì ìš©ë˜ë¯€ë¡œ ì—¬ëŸ¬ ê°œì˜ Modifierê°€ ìˆì„ ê²½ìš° ì—°ì‚° ìˆœì„œì— ë”°ë¼ ê²°ê³¼ë¬¼ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.

* *eg1) health(10) + vigor(9) * strength(10) -> 190*
  
* *eg2) health(10) * strength(10) + vigor(9) -> 109*

<br>

### **8.5. Coefficients**

<br>

![image](https://github.com/user-attachments/assets/4b8673db-d0ff-4eef-b565-7e35cb8633f6)


* Attribute Based Magnitude

  * ê³„ìˆ˜(`C`)

  * ì‚¬ì „ ë§ì…ˆ ê°’(`Pre`)

  * ì‚¬í›„ ë§ì…ˆ ê°’(`Post`)

  * eg) `C`( attribute + `Pre` ) + `Post`

<br>

# **Other Attributes**

<br>

## **8.6. Secondary Attrubutes**

<br>

* Attributes ë¶„ë¥˜

  * Primary Attributes: ì¢…ì†ë˜ì§€ ì•ŠëŠ” ë…ë¦½ì ì¸ ì†ì„±
  
    * `Str`, `Int`, `Res`, `Vig`

  * Secondary Attributes: ë‹¤ë¥¸ ì†ì„±ì—ì„œ íŒŒìƒë˜ëŠ” ì†ì„±

    * `Armor`(Res)

    * `Armor Penetration`(Res): íšŒë³µë ¥ì— ë”°ë¼ ë‹¬ë¼ì§, ì¼ì • ë¹„ìœ¨ ë¬´ì‹œ

    * `Block Chance`(Armor): ë“¤ì–´ì˜¤ëŠ” ëŒ€ë¯¸ì§€ëŠ” ì ˆë°˜ìœ¼ë¡œ ì¤„ì„
  
    * `Critical Hit Chance`(AP): í”¼í•´ë¥¼ ë‘ë°°ë¡œ ëŠ˜ë¦¬ê³  ì¹˜ëª…íƒ€ ë³´ë„ˆìŠ¤ ì¶”ê°€

    * `Critical Hit Damage`(AP): ì¹˜ëª…íƒ€ ë³´ë„ˆìŠ¤ ëŒ€ë¯¸ì§€ ì¦ê°€

    * `Critical Hit Resistance`(Armor): ì¹˜ëª…íƒ€ í™•ë¥  ê°ì†Œ 

    * `Health Regeneration`(Vig), `Mana Regeneration`(Int), `Max Health`(Vig), `Max Mana`(Int)

<br><br>

<details>
<summary>ì†ì„± ì¶”ê°€í•˜ëŠ” ê³¼ì •</summary>

  
```c++

/*
* AuraAttributeSet.h
*/

// 1. UPROPERTYì™€ ì†ì„±, ì†ì„± ì ‘ê·¼ì ì„ ë˜ (UPROPERTYì—ëŠ” í•´ë‹¹ ì†ì„±ì— ëŒ€í•œ notifyê°€ ìˆì–´ì•¼ í•¨)
UPROPERTY(BlueprintReadOnly, ReplicatedUsing = OnRep_Armor, Category = "Secondary Attributes")
FGameplayAttributeData Armor;
ATTRIBUTE_ACCESSORS(UAuraAttributeSet, Armor);

// ë…¸í‹°íŒŒì´ í•¨ìˆ˜ ì„ ì–¸
UFUNCTION()
void OnRep_Armor(const FGameplayAttributeData& OldArmor) const;


/*
* AuraAttributeSet.cpp
*/
// ê° ì†ì„±ì˜ ë„¤íŠ¸ì›Œí¬ ë³µì œ ì„¤ì •
DOREPLIFETIME_CONDITION_NOTIFY(UAuraAttributeSet, Armor, COND_None, REPNOTIFY_Always);

// ë…¸í‹°íŒŒì´ë¥¼ í†µí•´ ë‹¤ìŒ ì‚¬í•­ì„ ì•Œë¦´ ìˆ˜ ìˆìŒ(ìƒˆ ì†ì„± ê°’, ì´ì „ ì†ì„± ê°’)
void UAuraAttributeSet::OnRep_Armor(const FGameplayAttributeData& OldArmor) const
{
	GAMEPLAYATTRIBUTE_REPNOTIFY(UAuraAttributeSet, Armor, OldArmor);
}

```

</details>

<br>

## **8.7. Derived Attributes**

<br>

Secondary Attributesë¥¼ ìºë¦­í„°ì—ê²Œ ì ìš©ì‹œí‚¤ê¸° ìœ„í•´ CharacterBase í´ë˜ìŠ¤ì— `DefaultSecondaryAttributes`ì— ëŒ€í•œ `TSubclassOf`ë¥¼ ì ìš©ì‹œí‚¨ë‹¤. (Secondary AttributesëŠ” Primaryì˜ ì˜í–¥ì„ ë°›ìœ¼ë¯€ë¡œ PAê°€ ì´ˆê¸°í™”ëœ í›„ ì´ˆê¸°í™”ì‹œì¼œì•¼ í•˜ê¸° ë•Œë¬¸! í´ë˜ìŠ¤ê°€ ë‘ ê°œ í•„ìš”í•˜ë‹¤)

<br>

<details>
<summary>Code</summary>


``` c++
/*
* 1. AuraCharacterBase.h
*/
UPROPERTY(BlueprintReadOnly, EditAnywhere, Category="Attributes")
TSubclassOf<UGameplayEffect> DefaultPrimaryAttributes;

UPROPERTY(BlueprintReadOnly, EditAnywhere, Category="Attributes")
TSubclassOf<UGameplayEffect> DefaultSecondaryAttributes;


/*
* 2. AuraCharacter.cpp
*/ 
void AAuraCharacter::InitAbilityActorInfo()
{
	AAuraPlayerState* AuraPlayerState = GetPlayerState<AAuraPlayerState>();
	check(AuraPlayerState);
	
	AuraPlayerState->GetAbilitySystemComponent()->InitAbilityActorInfo(AuraPlayerState, this);

	// AuraPlayerStateì— ëŒ€í•œ AuraASCë¥¼ ìºìŠ¤íŠ¸í•´ AbilityActorInfoSetë¥¼ í˜¸ì¶œ => ì •ìƒì ìœ¼ë¡œ í˜¸ì¶œë˜ì—ˆë‹¤ë©´ ì˜ ì„¤ì •ëœ ê²ƒì„
	Cast<UAuraAbilitySystemComponent>(AuraPlayerState->GetAbilitySystemComponent())->AbilityActorInfoSet();
	
	AbilitySystemComponent = AuraPlayerState->GetAbilitySystemComponent();
	AttributeSet = AuraPlayerState->GetAttributeSet();

	if(AAuraPlayerController* AuraPlayerController = Cast<AAuraPlayerController>(GetController()))
	{
		if(AAuraHUD* AuraHUD = Cast<AAuraHUD>(AuraPlayerController->GetHUD()))
		{
			AuraHUD->InitOverlay(AuraPlayerController, AuraPlayerState, AbilitySystemComponent, AttributeSet);
		}

		// AuraControllerì™€ AuraHUDê°€ ì˜¬ë°”ë¥´ê²Œ ìºìŠ¤íŒ… ëœ ì´í›„ ìºë¦­í„°ì˜ ì†ì„±ì„ ë¶ˆëŸ¬ì˜´
		InitializeDefaultAttrubutes();
	}
}

/*
*  3. AuraCharacterBase.cpp
*/
void AAuraCharacterBase::ApplyEffectToSelf(TSubclassOf<UGameplayEffect> GameplayEffectClass, float Level) const
{
	// GAS ë° DefaultSecondaryAttributesê°€ ìœ íš¨í•œì§€ í™•ì¸
	check(IsValid(GetAbilitySystemComponent()));
	check(GameplayEffectClass);

	// MakeEffectContext() í•¨ìˆ˜ë¥¼ í†µí•´ ContextHandle ìƒì„±
	const FGameplayEffectContextHandle ContextHandle = GetAbilitySystemComponent()->MakeEffectContext();

	// DefaultSecondaryAttributesì˜ í•¸ë“¤ì„ ë§Œë“¦
	const FGameplayEffectSpecHandle SpecHandle = GetAbilitySystemComponent()->MakeOutgoingSpec(GameplayEffectClass, Level, ContextHandle);

	// ëŒ€ìƒ(ìºë¦­í„°ì˜ GAS)ì—ê²Œ SpecHandleì˜ ë°ì´í„° ì „ë‹¬
	GetAbilitySystemComponent()->ApplyGameplayEffectSpecToTarget(*SpecHandle.Data.Get(), GetAbilitySystemComponent());
}

void AAuraCharacterBase::InitializeDefaultAttrubutes() const
{
	/* Primary Attributesì™€ Secondary Attributesë¥¼ í•œ ë²ˆì— ì´ˆê¸°í™” */
	ApplyEffectToSelf(DefaultPrimaryAttributes, 1.f);
	ApplyEffectToSelf(DefaultSecondaryAttributes, 1.f);
}
```

</details>

<br>

> 
> **ì•Œì•„ë‘ì ì†ì„± ì´ˆê¸°í™” ë™ì‘ê³¼ì •!**
> 
> 1. ìºë¦­í„° ë² ì´ìŠ¤ í´ë˜ìŠ¤ í—¤ë”ì— ì´ˆê¸°í™” í•¨ìˆ˜ ì„ ì–¸
> 
> 2. ìºë¦­í„° í´ë˜ìŠ¤ì˜ ASC ì´ˆê¸°í™” í•¨ìˆ˜ì˜ êµ¬í˜„ë¶€ ë§ë‹¨ì— ì†ì„± ì´ˆê¸°í™” í•¨ìˆ˜ í˜¸ì¶œ
> 
> 3. ìºë¦­í„° ë² ì´ìŠ¤ í´ë˜ìŠ¤ì˜ ì†ì„± ì´ˆê¸°í™” êµ¬í˜„ë¶€ì—ì„œ ASCì— ì ‘ê·¼ -> í•´ë‹¹ íƒ€ê²Ÿì— ì ìš©
> 
> <br><br>
>
> **ğŸ””ë¦¬ë§ˆì¸ë“œğŸ””**
> 
> GASëŠ” ê²Œì„ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê°ì²´ë¥¼ Gameplay Effectë¡œ ë¶„ë¦¬í•´ ê´€ë¦¬í•œë‹¤.
>
> <br>
> 
> **GE ê´€ë ¨ í•¸ë“¤**
> 
> * **Gameplay Effect Context**: GameEffectì˜ Insgatorì™€ ëŒ€ìƒì— ëŒ€í•œ ì •ë³´(í•¨ìˆ˜, ë©¤ë²„ë³€ìˆ˜ ë“±)ê°€ ì €ì¥
> 
> * **Gameplay Effect Spec**: GEì™€ ê´€ë ¨ëœ ì •ë³´
> 
> <br>
> 
> `ContextHandle`ì´ ëŒ€ìƒì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ë©´ í•´ë‹¹ ì •ë³´ë¥¼ GESpecì— ë‹´ê³ , `SpecHandle`ì„ í†µí•´ í™œìš©í•œë‹¤(GASëŠ” ê°„ì ‘ì ìœ¼ë¡œ ë‹¤ë£¬ë‹¤!).
>
> [**GASì˜ Attribute ë° Effect ë¬¸ì„œ**](https://dev.epicgames.com/documentation/ko-kr/unreal-engine/gameplay-attributes-and-gameplay-effects-for-the-gameplay-ability-system-in-unreal-engine?application_version=5.0)

<br><br>

*GE_AuraSecondaryAttributes*

![image](https://github.com/user-attachments/assets/57196891-31bd-4b21-bf6b-abc5e8e4136b)

* Duration Policyë¥¼ Infiniteë¡œ ì„¤ì •

* eg) Modifiers[0]
  
  * `Amor` Attributeë¥¼ ì¡°ì‘
  
  * Baseê°€ ë  Attributeë¥¼ ê¸°ë°˜ìœ¼ë¡œ override
  
  * ê³„ìˆ˜: Base Attributeì— 0.5ë¥¼ ê³±í•˜ê³  6.0ì„ ë”í•œ ê°’
  
  * Backing Attribute
  
	* Baseê°€ ë  Attribute: `Resilience`
	
	* Attribute ê³„ì‚° ê²°ê³¼: `Target`ì— ì ìš©

  * *res) Aura ìºë¦­í„°ì˜ Amor ê°’ì— 0.25 * (2 + `Res`) + 6 = 9.5 ì ìš©*
  
  	![image](https://github.com/user-attachments/assets/41d5236b-2587-42ef-bf60-2a89217e88b2)
