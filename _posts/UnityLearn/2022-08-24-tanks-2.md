---
title: "Tanks #2"
 
header:
  overlay_image: https://user-images.githubusercontent.com/93882395/187725371-5ffceddc-c093-4a95-a508-95ba026736d9.jpg
  overlay_filter: 0.7 # 투명도

categories:
  - UnityLearn

tags:
  - Unity
  - UnityLearn
  - Tutorial
  - Game
  - Tanks

toc: true
toc_sticky: true
toc_label: "Tanks"
toc_icon: "fa-thin fa-truck-monster"
last_modified_at: 2022-08-24

use_math: true
---



> ***🤍ref.***
>
> 1. [**Unity Learn**  *Tanks*](https://learn.unity.com/project/tanks-tutorial?uv=5.x)
> 2. [Unity Documentation](https://docs.unity3d.com/kr/2021.3/Manual/UnityManual.html)



***✨Unity info***<br> 본 튜토리얼 문서의 유니티 버전은 ***5.2** v*이나, ***2021.3.8f1** v*으로 실습 후 게시글을 작성하였습니다.
{: .notice--info}



잘못 이해한 부분이나 오역이 있다면 메일 부탁드립니다. 감사합니다.🙇‍♀️<br>✉️ *link*: *[yj.osoq@gmail.com](mailto:yj.osoq@gmail.com)*
{: .notice--primary}

---

<br>

# ⚙️Tank Creation & Control

<br>

## 1. **Layers**

![image](https://user-images.githubusercontent.com/93882395/187814762-645c770c-252e-4db4-a3ca-722ed67ccb34.png)

Tank 오브젝트의 Layer를 Player로 설정한다. 두 플레이어가 서로 공격할 때, 건물이나 땅을 제외한 탱크만 폭파시킬 수 있도록 한다.

* **[Layer](https://docs.unity3d.com/kr/2020.3/Manual/Layers.html)**: 카메라가 일부 씬만 렌더링하거나, 콜라이더를 선택적으로 무시하기 위해 사용

![image](https://user-images.githubusercontent.com/93882395/187814907-19183219-47c5-4f57-b214-f4b4b2fd1cf4.png)

자식 오브젝트들의 레이어 변경 여부를 묻는 메시지 창이 나타난다. 튜토리얼에서는 탱크의 가장 부모 오브젝트인 부분만 충돌하면 되므로, `No, this object only`를 클릭해준다.

<br>

---

## 2. Audio

![image](https://user-images.githubusercontent.com/93882395/187821988-04e67665-c802-45ec-9d07-733941ec211c.png)

게임이 진행되는 동안, 탱크의 엔진은 항상 동작할 것이므로 EngineIdle 클립을 설정한 후, Loop 프로퍼티를 체크해준다. 이후 오디오 컴포넌트를 하나 더 생성한 후, 오디오 소스에 재생할 특정 오디오 클립을 알려주기 위해 재생 체크 박스를 모두 해제해준다.

<br>

이후 게임 매니저 오브젝트에 의해서 탱크가 생성되도록 프리팹화한다. *(Scene에 단순 게임 오브젝트로 남아있지 않도록 한다.)* 프리팹으로 여러 대의 탱크를 생성해 멀티 플레이가 가능하도록 할 수 있다.

<br>

---

## 3. 3D Mesh

![ezgif com-gif-maker (8)](https://user-images.githubusercontent.com/93882395/187843104-f5bd10e3-bb1e-488d-beb8-f052272c815a.gif)

> DustTrail 모델을 드래그했을 때의 애니메이션 효과

![image](https://user-images.githubusercontent.com/93882395/187844743-b0d62403-6dcd-4b25-adfe-330ef8db07ea.png)

탱크가 움직일 때 탱크 오브젝트  주변에 먼지가 날리는 애니메이션이 발생하도록 DustTrail 모델을 자식 오브젝트로 드래그한다.

![image](https://user-images.githubusercontent.com/93882395/187844599-85ff46fb-a5c9-41c1-a7d5-d041065fdf73.png)

![image](https://user-images.githubusercontent.com/93882395/187844686-c012a6e2-4334-495b-a976-92c568f54fac.png)

Simulation Space 프로퍼티를 World로 설정한 후, Emission을 Distance로 지정해 주어 이동거리마다 입자가 방출하는 효과를 낼 수 있다.

* `Rate over Distance`: 한 번에 이동할 때마다 방출되는 입자의 수

<br>

![image](https://user-images.githubusercontent.com/93882395/187845224-2f9eb2a1-3bf0-4554-85e4-498482d0c119.png)

> 입자들의 생성부터 소멸까지의 size와 Lifetime. `Size over Lifetime` 프로퍼티에서 확인할 수 있다.

<br>

탱크의 트랙(바퀴의 열)마다 먼지가 날리는 애니메이션이 발생해야 하므로, DustTrail을 복사해 LeftDustTrail과 RightDustTrail을 만들어준다. (`^D`)

* LeftDustTrail의 Position: ( -0.5, 0, -0.75 )
* RightDustTrail의 Position: ( 0.5, 0, -0.75 )

<br>

---

## 4. TankMovement.cs

> 오디오 설정, 전후 이동, turn 설정
>
> * `m_`: 멤버 변수. 
>   * 드래그앤드롭이나 에디터에서 게임을 디자인할 때 사용하는 것이 아닌 변수는 대부분 `private`으로 선언한다. (단순히 기능성을 위해 만들어짐)
>   * `public`으로 선언되는 경우: 속도, 회전 속도, 게임 내 동작 조정

<br>

<script src="https://gist.github.com/yj59/6825cb2ac3a476b6d5685da0cccbe31d.js"></script>

* `m_PlayerNumber`: 플레이어 번호.
  * tank manager가 얼마나 많은 탱크가 있고, 어떤 조작이 어떤 탱크에 할당되는 것인지 관리하기 위해 사용
  * 만약 tank1이 이겼을 경우 UI에 플레이어 1이 이겼음을 알리거나, `1`에 해당하는 입력 키들이 tank1을 조종
    * [Input Manager](https://docs.unity3d.com/kr/2021.3/Manual/class-InputManager.html)에서도 움직임을 조작할 수 있으나, 플레이어 번호를 지정하면 작동 방식 간략화 가능
* `m_Speed`: 탱크의 속도
* `m_TurnSpeed`: 시간에 따른 회전 각도
* `m_MovementAudio`: 엔진 동작 소리를 나타내는 오디오 소스
  * 상황마다 변수에 다른 오디오 소스를 할당하여 운전할 때와 정지할 때 다른 클립 재생 가능
* `m_PitchRange`: 음 높이 범위. 이후 랜덤값을 넣어 탱크마다 엔진 소리를 다르게 함

<br>

![image](https://user-images.githubusercontent.com/93882395/187855641-d9841530-5975-4be5-b3b5-7ad4539a8f26.png)

* Input Manager의 입력 키값을 문자열으로 받기 위해 `m_MovementAxisName`과 `m_TurnAxisName` 모두 String으로 선언
  * `m_MovementAxisName` 수평 axis
  * `m_TurnAxisName`: 수직 axis
* `m_Rigidbody`: 탱크의 차체를 움직이게 하기 위해 사용
* `m_MovementInputValue`, `m_TurnInputValue`: 실제로 입력을 받았을 때의 값
  * 변수에 입력값을 저장하고 원하는 메서드에 활용 가능
* `m_OriginalPitch`: 원본 소리의 높낮이를 기준으로 음높이 변경
  * 높낮이 기준이 현재 pitch가 되면 엔진 효과음이 계속 높아질 수 있음

<br>

<script src="https://gist.github.com/yj59/493c5c98b90216dc0dd33b6fbb1559db.js"></script>



* `OnEnable()`: 게임 시작 후 `Awake()`와 `Update()` 메서드 사이에 호출
  * `.isKinematic = false`: 탱크의 rigidbody가 [Kinematic](https://docs.unity3d.com/kr/2021.3/ScriptReference/Rigidbody-isKinematic.html)을 따르지 않도록 함 
    * isKinematic: true시 강체가 운동학의 영향만을 받음. 물리학 계산 무시
    * 강체가 운동학을 따를 경우 이동하는데 문제 발생
* `OnDisable()`: 게임을 종료할 때 호출
  * `.isKinematic = true`: 탱크가 폭발할 때는(게임 종료) 더이상 탱크에 힘이 가해지지 않도록 운동학 사용

<br>

<script src="https://gist.github.com/yj59/979704746a5bf86930bffdc448f5f887.js"></script>

* **`Start()`**
  * `m_MovementAxisName`, `m_TurnAxisName`: 각각 수평, 수직 이동 축에 `m_PlayerNumber` 변수를 결합해 Input Manager가 어느 플레이어의 이동값인지 확인할 수 있도록 함
  * `m_OriginalPitch`: 이동 효과음의 원본 음역대 저장

![image](https://user-images.githubusercontent.com/93882395/187862392-8f4b2985-f8ac-4944-9a5e-c6aeb292cfbf.png)

> Audio Source 컴포넌트의 프로퍼티 **(Pitch)**
>
> 오디오 클립이  스크립트에 할당되면 Pitch 값을 얻거나 조작할 수 있다!

<br>

* **`Update()`**: 모든 프레임 실행
  * `Input.GetAxis()`: Input Manager에서 입력값 할당
    * 프레임 update마다 입력값이 계산되므로, `Update()`메서드에서 Input을 받는 것이 가장 바람직함
    * 인자는 일반적으로 String 변수
  * `EngineAudio();` 모든 프레임마다 올바른 오디오를 재생하도록 업데이트에서 선언

<br>

<script src="https://gist.github.com/yj59/312b618b2f1283459458741fb3474d49.js"></script>

* **`EngineAudio()`**
